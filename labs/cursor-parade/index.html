<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cursor Parade</title>
    <style>
      :root {
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        overflow: hidden;
        background: radial-gradient(circle at 20% 20%, #1d2f77 0%, #0b0620 45%, #05030d 100%);
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        color: #eef2ff;
      }

      #screen {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
      }

      .hud {
        position: fixed;
        top: 12px;
        left: 12px;
        right: 12px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
        pointer-events: none;
      }

      .card {
        background: rgba(11, 8, 28, 0.64);
        border: 1px solid rgba(155, 177, 255, 0.35);
        border-radius: 14px;
        padding: 10px 12px;
        backdrop-filter: blur(8px);
        box-shadow: 0 8px 28px rgba(0, 0, 0, 0.35);
      }

      h1 {
        margin: 0 0 4px;
        font-size: clamp(1rem, 2.7vw, 1.2rem);
      }

      .small {
        margin: 0;
        font-size: 0.82rem;
        color: #c7d2ff;
        line-height: 1.35;
      }

      .stats {
        min-width: 150px;
        text-align: right;
      }

      .badge {
        display: inline-block;
        margin-top: 6px;
        padding: 4px 8px;
        border-radius: 999px;
        font-size: 0.72rem;
        font-weight: 700;
        letter-spacing: 0.02em;
        background: rgba(101, 75, 227, 0.32);
        border: 1px solid rgba(163, 148, 255, 0.7);
      }

      .hint {
        position: fixed;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.78rem;
        opacity: 0.82;
        background: rgba(11, 8, 28, 0.7);
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid rgba(135, 165, 255, 0.35);
      }

      @media (max-width: 640px) {
        .hud {
          flex-direction: column;
        }

        .stats {
          text-align: left;
        }
      }
    </style>
  </head>
  <body>
    <canvas id="screen"></canvas>

    <div class="hud">
      <div class="card">
        <h1>üåÄ Cursor Parade</h1>
        <p class="small">Move your cursor/finger: a parade of tiny chaotic followers tries to imitate you.</p>
        <p class="small">Tap/click to split reality (mirror mode).</p>
      </div>

      <div class="card stats">
        <p class="small"><strong id="followers">0</strong> followers</p>
        <p class="small"><strong id="chaos">0</strong>% chaos</p>
        <span class="badge" id="mode">NORMAL SPACE</span>
      </div>
    </div>

    <div class="hint">Space = freeze burst ‚Ä¢ R = reset ‚Ä¢ Click = mirror universe</div>

    <script>
      (() => {
        const canvas = document.getElementById('screen');
        const ctx = canvas.getContext('2d');

        const followersEl = document.getElementById('followers');
        const chaosEl = document.getElementById('chaos');
        const modeEl = document.getElementById('mode');

        let width = 0;
        let height = 0;
        let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

        const POINTER = { x: 0, y: 0, moved: false };
        let mirrorMode = false;
        let freezePulse = 0;

        const EMOJIS = ['‚ú®', 'ü´ß', 'üß†', 'üçú', 'ü¶Ñ', '‚ö°', 'üõ∞Ô∏è', 'üç£', 'ü¶ë', 'üõ∏'];

        const followers = [];
        const sparks = [];

        function resize() {
          width = window.innerWidth;
          height = window.innerHeight;
          canvas.width = Math.floor(width * dpr);
          canvas.height = Math.floor(height * dpr);
          canvas.style.width = `${width}px`;
          canvas.style.height = `${height}px`;
          ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

          if (!POINTER.moved) {
            POINTER.x = width * 0.5;
            POINTER.y = height * 0.5;
          }
        }

        function createFollower(i) {
          return {
            x: Math.random() * width,
            y: Math.random() * height,
            vx: (Math.random() - 0.5) * 2,
            vy: (Math.random() - 0.5) * 2,
            drag: 0.88 + Math.random() * 0.09,
            spring: 0.018 + Math.random() * 0.042,
            wobble: Math.random() * Math.PI * 2,
            size: 3 + Math.random() * 6,
            hue: (i * 360) / 96 + Math.random() * 40,
            lag: Math.random() * 0.75,
          };
        }

        function populate(count = 96) {
          followers.length = 0;
          for (let i = 0; i < count; i += 1) {
            followers.push(createFollower(i));
          }
          followersEl.textContent = String(followers.length);
        }

        function spawnBurst(x, y, amount = 36) {
          for (let i = 0; i < amount; i += 1) {
            const angle = Math.random() * Math.PI * 2;
            const speed = 1 + Math.random() * 6;
            sparks.push({
              x,
              y,
              vx: Math.cos(angle) * speed,
              vy: Math.sin(angle) * speed,
              life: 40 + Math.random() * 40,
              maxLife: 80,
              emoji: EMOJIS[(Math.random() * EMOJIS.length) | 0],
              size: 10 + Math.random() * 10,
            });
          }
        }

        function pointerTarget() {
          if (!mirrorMode) return { x: POINTER.x, y: POINTER.y };
          return { x: width - POINTER.x, y: height - POINTER.y };
        }

        function update() {
          const target = pointerTarget();
          let chaosAccumulator = 0;

          for (let i = 0; i < followers.length; i += 1) {
            const f = followers[i];
            f.wobble += 0.025 + f.lag * 0.025;

            const ghostX = target.x + Math.cos(f.wobble * (1.2 + f.lag)) * 28 * (0.2 + f.lag);
            const ghostY = target.y + Math.sin(f.wobble * (0.9 + f.lag * 1.4)) * 22 * (0.2 + f.lag);

            f.vx += (ghostX - f.x) * f.spring;
            f.vy += (ghostY - f.y) * f.spring;

            if (freezePulse > 0) {
              f.vx *= 0.5;
              f.vy *= 0.5;
            }

            f.vx *= f.drag;
            f.vy *= f.drag;

            f.x += f.vx;
            f.y += f.vy;

            if (f.x < -40) f.x = width + 40;
            else if (f.x > width + 40) f.x = -40;
            if (f.y < -40) f.y = height + 40;
            else if (f.y > height + 40) f.y = -40;

            chaosAccumulator += Math.hypot(f.vx, f.vy);
          }

          for (let i = sparks.length - 1; i >= 0; i -= 1) {
            const s = sparks[i];
            s.x += s.vx;
            s.y += s.vy;
            s.vx *= 0.98;
            s.vy *= 0.98;
            s.vy += 0.02;
            s.life -= 1;
            if (s.life <= 0) sparks.splice(i, 1);
          }

          if (freezePulse > 0) freezePulse -= 1;

          const chaos = Math.min(100, Math.round((chaosAccumulator / followers.length) * 18));
          chaosEl.textContent = String(chaos);
        }

        function render() {
          ctx.fillStyle = 'rgba(6, 4, 16, 0.18)';
          ctx.fillRect(0, 0, width, height);

          const grd = ctx.createRadialGradient(POINTER.x, POINTER.y, 0, POINTER.x, POINTER.y, 240);
          grd.addColorStop(0, mirrorMode ? 'rgba(255,92,176,0.25)' : 'rgba(82,132,255,0.26)');
          grd.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = grd;
          ctx.beginPath();
          ctx.arc(POINTER.x, POINTER.y, 240, 0, Math.PI * 2);
          ctx.fill();

          for (let i = 0; i < followers.length; i += 1) {
            const f = followers[i];
            const alpha = 0.45 + f.lag * 0.35;
            ctx.fillStyle = `hsla(${f.hue + Math.sin(f.wobble) * 28}, 92%, 67%, ${alpha})`;
            ctx.beginPath();
            ctx.arc(f.x, f.y, f.size, 0, Math.PI * 2);
            ctx.fill();
          }

          for (let i = 0; i < sparks.length; i += 1) {
            const s = sparks[i];
            const a = Math.max(0, s.life / s.maxLife);
            ctx.globalAlpha = a;
            ctx.font = `${s.size}px system-ui, Apple Color Emoji, Segoe UI Emoji`;
            ctx.fillText(s.emoji, s.x, s.y);
            ctx.globalAlpha = 1;
          }

          if (freezePulse > 0) {
            ctx.strokeStyle = `rgba(188, 214, 255, ${0.15 + freezePulse * 0.01})`;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(POINTER.x, POINTER.y, 36 + (20 - freezePulse) * 8, 0, Math.PI * 2);
            ctx.stroke();
          }

          ctx.fillStyle = '#ffffff';
          ctx.beginPath();
          ctx.arc(POINTER.x, POINTER.y, 3.5, 0, Math.PI * 2);
          ctx.fill();
        }

        function loop() {
          update();
          render();
          requestAnimationFrame(loop);
        }

        function setPointer(x, y) {
          POINTER.x = x;
          POINTER.y = y;
          POINTER.moved = true;
        }

        window.addEventListener('mousemove', (event) => {
          setPointer(event.clientX, event.clientY);
        });

        window.addEventListener('touchmove', (event) => {
          if (event.touches[0]) {
            setPointer(event.touches[0].clientX, event.touches[0].clientY);
          }
        }, { passive: true });

        function toggleMirror(x, y) {
          mirrorMode = !mirrorMode;
          modeEl.textContent = mirrorMode ? 'MIRROR UNIVERSE' : 'NORMAL SPACE';
          spawnBurst(x, y, mirrorMode ? 56 : 30);
        }

        window.addEventListener('click', (event) => {
          setPointer(event.clientX, event.clientY);
          toggleMirror(event.clientX, event.clientY);
        });

        window.addEventListener('keydown', (event) => {
          if (event.code === 'Space') {
            event.preventDefault();
            freezePulse = 20;
            spawnBurst(POINTER.x, POINTER.y, 18);
          }

          if (event.key.toLowerCase() === 'r') {
            populate();
            sparks.length = 0;
            spawnBurst(width * 0.5, height * 0.5, 48);
          }
        });

        window.addEventListener('resize', resize);

        resize();
        populate();
        spawnBurst(width * 0.5, height * 0.5, 42);
        loop();
      })();
    </script>
  </body>
</html>
